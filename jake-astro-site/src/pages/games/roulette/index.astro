---
import Page from "../../../layouts/Page.astro";
---

<Page title="Roulette">
    <div class="main">
        <button class="btn" id="spin">
            <span class="btn-label">Spin</span>
        </button>
        <button class="btn hide" id="reset">
            <span class="btn-label">New Game</span>
        </button>
        <div class="plate" id="plate">
            <ul id="inner" class="inner">
                <li class="number"><label><input type="radio" name="pit" value="32" /><span class="pit">32</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="15" /><span class="pit">15</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="19" /><span class="pit">19</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="4" /><span class="pit">4</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="21" /><span class="pit">21</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="2" /><span class="pit">2</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="25" /><span class="pit">25</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="17" /><span class="pit">17</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="34" /><span class="pit">34</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="6" /><span class="pit">6</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="27" /><span class="pit">27</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="13" /><span class="pit">13</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="36" /><span class="pit">36</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="11" /><span class="pit">11</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="30" /><span class="pit">30</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="8" /><span class="pit">8</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="23" /><span class="pit">23</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="10" /><span class="pit">10</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="5" /><span class="pit">5</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="24" /><span class="pit">24</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="16" /><span class="pit">16</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="33" /><span class="pit">33</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="1" /><span class="pit">1</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="20" /><span class="pit">20</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="14" /><span class="pit">14</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="31" /><span class="pit">31</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="9" /><span class="pit">9</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="22" /><span class="pit">22</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="18" /><span class="pit">18</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="29" /><span class="pit">29</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="7" /><span class="pit">7</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="28" /><span class="pit">28</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="12" /><span class="pit">12</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="35" /><span class="pit">35</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="3" /><span class="pit">3</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="26" /><span class="pit">26</span></label></li>
                <li class="number"><label><input type="radio" name="pit" value="0" /><span class="pit">0</span></label></li>
            </ul>
            <div class="data" id="data">
                <div class="data-inner">
                    <div id="mask" class="mask">Place Your Bets</div>
                    <div class="result">
                        <div class="result-number">00</div>
                        <div class="result-color">red</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="previous-results">
            <ol class="previous-list"></ol>
        </div>
    </div>
</Page>

<style>
    @keyframes rotate {
        0% {
            transform: rotateZ(0deg);
        }
        100% {
            transform: rotateZ(360deg);
        }
    }
    @keyframes flipin {
        0% {
            transform: rotateX(0deg);
        }
        100% {
            transform: rotateX(90deg);
        }
    }
    .main {
        width: 374px;
        margin: 0 auto;
    }

    .plate {
        background-color: gray;
        width: 350px;
        height: 350px;
        margin: 12px;
        border-radius: 50%;
        position: relative;
        animation: rotate 24s infinite linear;
    }
    .plate:after,
    .plate:before {
        content: "";
        display: block;
        position: absolute;
        border-radius: 50%;
    }

    .plate:after {
        top: -6px;
        right: -6px;
        bottom: -6px;
        left: -6px;
        border: 6px solid gold;
        box-shadow:
            inset 0px 0px 0px 6px / 3 darken(gold, 15%),
            0px 0px 0px 6px / 3 lighten(gold, 25%);
    }

    .plate:before {
        background: rgba(0, 0, 0, 0.65);
        border: 1px solid silver;
        box-shadow: inset 0px 0px 0px 2px darken(silver, 25%);
        top: 12%;
        left: 12%;
        right: 12%;
        bottom: 12%;
        z-index: 1;
    }

    .number {
        width: 32px;
        height: 175px;
        display: inline-block;
        text-align: center;
        position: absolute;
        top: 0;
        left: calc(50% - 16px);
        transform-origin: 50% 100%;
        background-color: transparent;
        border-left: 16px solid transparent;
        border-right: 16px solid transparent;
        border-top: 175px solid black;
        box-sizing: border-box;

        --rot: calc(360deg / 37);
    }
    .number:nth-child(odd) {
        border-top-color: red;
    }
    .number:nth-child(37) {
        border-top-color: green;
    }

    .number:nth-child(1) {
        transform: rotateZ(calc(var(--rot) * 1));
    }
    .number:nth-child(2) {
        transform: rotateZ(calc(var(--rot) * 2));
    }
    .number:nth-child(3) {
        transform: rotateZ(calc(var(--rot) * 3));
    }
    .number:nth-child(4) {
        transform: rotateZ(calc(var(--rot) * 4));
    }
    .number:nth-child(5) {
        transform: rotateZ(calc(var(--rot) * 5));
    }
    .number:nth-child(6) {
        transform: rotateZ(calc(var(--rot) * 6));
    }
    .number:nth-child(7) {
        transform: rotateZ(calc(var(--rot) * 7));
    }
    .number:nth-child(8) {
        transform: rotateZ(calc(var(--rot) * 8));
    }
    .number:nth-child(9) {
        transform: rotateZ(calc(var(--rot) * 9));
    }
    .number:nth-child(10) {
        transform: rotateZ(calc(var(--rot) * 10));
    }
    .number:nth-child(11) {
        transform: rotateZ(calc(var(--rot) * 11));
    }
    .number:nth-child(12) {
        transform: rotateZ(calc(var(--rot) * 12));
    }
    .number:nth-child(13) {
        transform: rotateZ(calc(var(--rot) * 13));
    }
    .number:nth-child(14) {
        transform: rotateZ(calc(var(--rot) * 14));
    }
    .number:nth-child(15) {
        transform: rotateZ(calc(var(--rot) * 15));
    }
    .number:nth-child(16) {
        transform: rotateZ(calc(var(--rot) * 16));
    }
    .number:nth-child(17) {
        transform: rotateZ(calc(var(--rot) * 17));
    }
    .number:nth-child(18) {
        transform: rotateZ(calc(var(--rot) * 18));
    }
    .number:nth-child(19) {
        transform: rotateZ(calc(var(--rot) * 19));
    }
    .number:nth-child(20) {
        transform: rotateZ(calc(var(--rot) * 20));
    }
    .number:nth-child(21) {
        transform: rotateZ(calc(var(--rot) * 21));
    }
    .number:nth-child(22) {
        transform: rotateZ(calc(var(--rot) * 22));
    }
    .number:nth-child(23) {
        transform: rotateZ(calc(var(--rot) * 23));
    }
    .number:nth-child(24) {
        transform: rotateZ(calc(var(--rot) * 24));
    }
    .number:nth-child(25) {
        transform: rotateZ(calc(var(--rot) * 25));
    }

    .number:nth-child(26) {
        transform: rotateZ(calc(var(--rot) * 26));
    }
    .number:nth-child(27) {
        transform: rotateZ(calc(var(--rot) * 27));
    }
    .number:nth-child(28) {
        transform: rotateZ(calc(var(--rot) * 28));
    }

    .number:nth-child(29) {
        transform: rotateZ(calc(var(--rot) * 29));
    }
    .number:nth-child(30) {
        transform: rotateZ(calc(var(--rot) * 30));
    }
    .number:nth-child(31) {
        transform: rotateZ(calc(var(--rot) * 31));
    }

    .number:nth-child(32) {
        transform: rotateZ(calc(var(--rot) * 32));
    }
    .number:nth-child(33) {
        transform: rotateZ(calc(var(--rot) * 33));
    }
    .number:nth-child(34) {
        transform: rotateZ(calc(var(--rot) * 34));
    }
    .number:nth-child(35) {
        transform: rotateZ(calc(var(--rot) * 35));
    }
    .number:nth-child(36) {
        transform: rotateZ(calc(var(--rot) * 36));
    }

    .pit {
        color: #fff;
        padding-top: 12px;
        width: 32px;
        display: inline-block;
        font-size: 12px;
        transform: scale(1, 1.8);
        position: absolute;
        top: -175px;
        left: -16px;
    }

    .inner {
        display: block;
        height: 350px;
        width: 350px;
        position: relative;
        --spins: 8;
    }

    .inner:after,
    .inner:before {
        content: "";
        display: block;
        position: absolute;
        border-radius: 50%;
    }
    .inner:after {
        z-index: 3;
        top: 24%;
        right: 24%;
        bottom: 24%;
        left: 24%;
        /* background-color: darken(silver, 45%); */
        border: 3px solid darken(silver, 25%);
    }
    .inner:before {
        top: 24%;
        bottom: 21%;
        left: 24%;
        right: 24%;
        content: "";
        color: #fff;
        font-size: 60px;
        z-index: 5;
        border-radius: 0;
    }

    .inner[data-spinto="1"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 278deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="2"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 106deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="3"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 30deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="4"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 87deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="5"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 238deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="6"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 146deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="7"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 354deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="8"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 207deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="9"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 316deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="10"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 228deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="11"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 187deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="12"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 12deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="13"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 166deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="14"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 298deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="15"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 67deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="16"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 258deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="17"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 125deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="18"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 335deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="19"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 77deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="20"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 288deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="21"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 96deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="22"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 326deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="23"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 218deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="24"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 248deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="25"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 116deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="26"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 40deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="27"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 156deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="28"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 3deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="29"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 345deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="30"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 196deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="31"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 307deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="32"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 58deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="33"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 268deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="34"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 135deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="35"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 381deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="36"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 177deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }
    .inner[data-spinto="0"]:before {
        transform: rotateZ(calc((-360deg * var(--spins)) + 49deg + 5deg));
        transition: transform 9s ease-out;
        content: "\2022";
    }

    .inner.rest:before {
        transition:
            top 0.5s ease-in,
            right 0.5s ease-in,
            bottom 0.5s ease-in,
            left 0.5s ease-in;
        top: 25%;
        right: 25%;
        bottom: 24%;
        left: 25%;
    }

    .data {
        display: block;
        position: absolute;
        top: 30%;
        right: 30%;
        bottom: 30%;
        left: 30%;
        border-radius: 50%;
        animation: rotate 24s reverse linear infinite;
        perspective: 2000px;
        z-index: 100;
    }

    .data-inner {
        position: relative;
        width: 100%;
        height: 100%;
        text-align: center;
        transition: transform 0.72s;
        transform-style: preserve-3d;
    }

    .data.reveal .data-inner {
        transform: rotateY(180deg);
    }

    .mask,
    .result {
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        position: absolute;
        backface-visibility: hidden;
        border-radius: 50%;
        overflow: hidden;
        display: inline-block;
    }

    .mask {
        color: #fff;
        font-size: 24px;
        margin: auto;
        line-height: 1.4;
        padding-top: 36px;
    }

    .result {
        background-color: green;
        color: white;
        transform: rotateY(180deg);
        align-items: center;
        color: #fff;
    }

    .result-number {
        font-size: 72px;
        font-weight: 500;
        line-height: 1.2;
        margin-top: 12px;
    }

    .result-color {
        text-transform: uppercase;
        font-size: 21px;
        line-height: 1;
    }

    .previous-results {
        max-width: 350px;
        margin: 24px 12px;
    }

    .previous-list {
        perspective: 2000;
    }

    .previous-result {
        display: flex;
        margin: 1px;
        padding: 12px;
        color: #fff;
    }

    .previous-result:nth-child(0) {
        animation: flipin 0.48s ease-out;
    }
    .previous-number {
        flex: 1;
    }

    .hide {
        display: none;
    }
    .color-green {
        background-color: green;
    }
    .color-black {
        background-color: black;
    }
    .color-red {
        background-color: red;
    }
</style>

<script>
    const inner = document.getElementById("inner") as HTMLUListElement;
    const spin = document.getElementById("spin") as HTMLButtonElement;

    const reset = document.getElementById("reset") as HTMLButtonElement;
    const data = document.getElementById("data") as HTMLDivElement;
    const mask = document.getElementById("mask") as HTMLDivElement;
    var timer = 9000;

    const result = document.querySelector(".result") as HTMLDivElement;
    const res_num = document.querySelector(".result-number") as HTMLDivElement;
    const res_col = document.querySelector(".result-color") as HTMLDivElement;

    const prev = document.querySelector(".previous-results") as HTMLDivElement;

    const colors = [
        "green", //0
        "red", //1
        "black", //2
        "red", //3
        "black", //4
        "red", //5
        "black", //6
        "red", //7
        "black", //8
        "red", //9
        "black", //10
        "black", //11
        "red", //12
        "black", //13
        "red", //14
        "black", //15
        "red", //16
        "black", //17
        "red", //18
        "red", //19
        "black", //20
        "red", //21
        "black", //22
        "red", //23
        "black", //24
        "red", //25
        "black", //26
        "red", //27
        "black", //28
        "black", //29
        "red", //30
        "black", //31
        "red", //32
        "black", //33
        "red", //34
        "black", //35
        "red", //36
    ];

    spin.onclick = () => {
        // get a random number between 0 and 36 and apply it to the nth-child selector
        const rdm = Math.floor(Math.random() * 1000) % 37;

        inner.dataset.spinto = "" + rdm;

        const spots = inner.querySelectorAll("input") as NodeListOf<HTMLInputElement>;
        const spot = spots[rdm];

        spot.checked = true;
        // prevent repeated clicks on the spin button by hiding it
        spin.classList.add("hide");
        // disable the reset button until the ball has stopped spinning
        reset.classList.add("disabled");

        setTimeout(() => {
            mask.innerText = "No More Bets";
        }, timer / 2);

        setTimeout(() => {
            mask.innerText = "Place Your Bets";
        }, timer + 500);

        // remove the disabled attribute when the ball has stopped
        setTimeout(() => {
            reset.classList.remove("disabled");
            const color = colors[rdm];
            res_num.innerText = "" + rdm;
            res_col.innerText = color;
            result.classList.add("color-" + color);
            data.classList.add("reveal");
            inner.classList.add("rest");

            const item = document.createElement("li");
            item.classList.add("previous-result");
            item.classList.add("color-" + color);

            const numberSpan = document.createElement("span");
            numberSpan.classList.add("previous-number");
            numberSpan.innerText = "" + rdm;

            const colorSpan = document.createElement("span");
            colorSpan.classList.add("previous-color");
            colorSpan.innerText = color;

            item.appendChild(numberSpan);
            item.appendChild(colorSpan);

            prev.prepend(item);
        }, timer);
    };

    reset.onclick = () => {
        // remove the spinto data attr so the ball 'resets'
        inner.dataset.spinto = "";
        inner.classList.remove("rest");
        reset.classList.add("hide");
        spin.classList.remove("hide");
        data.classList.remove("reveal");
    };

    // so you can swipe it too
    const plate = document.getElementById("plate") as HTMLDivElement;
    // var mc = new Hammer(myElement);
    plate.onscroll = () => {
        if (!reset.classList.contains("disabled")) {
            if (!spin.classList.contains("hide")) {
                spin.click();
            } else {
                reset.click();
            }
        }
    };
</script>
