import"./hoisted.DPgqRxNp.js";const b=["C","D","H","S"],L=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"],v={A:11,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10};class B{faceUp=!1;suit;rank;get score(){return v[this.rank]}constructor(e,r){this.suit=b[e],this.rank=L[r]}toString(){return`${this.suit}-${this.rank}`}flip(){this.faceUp=!this.faceUp}show(){this.faceUp=!0}hide(){this.faceUp=!1}}class M{cards=[];constructor(){for(let e=0;e<4;e++)for(let r=1;r<=13;r++)this.cards.push(new B(e,r))}shuffle(e=1e3){const r=this.cards.length-1;for(let c=0;c<e;c++){const t=c%r,u=this.cards[t],n=Math.floor(Math.random()*r);this.cards[t]=this.cards[n],this.cards[n]=u}}draw(e=2){return this.cards.splice(0,e)}toString(){return this.cards.map(e=>e.toString()).join(" ")}}class l{chips;deck;player=[];dealer=[];get playerScore(){return l.count(this.player)}get dealerScore(){return l.count(this.dealer)}constructor(e){this.chips=e,this.deck=new M}deal(e){if(this.chips<5){alert("You're out of chips!");return}this.chips-=e,this.deck.shuffle(),this.player=this.deck.draw(2),this.dealer=this.deck.draw(2)}hit(){const e=this.deck.draw(1)[0];this.player.push(e),console.log("hit player:",this.player)}stand(){for(;l.count(this.dealer)<17;){const c=this.deck.draw(1)[0];this.dealer.push(c),console.log("hit dealer:",this.dealer)}const e=l.count(this.dealer);console.log("dealer:",this.dealer,e);const r=l.count(this.player);console.log("player:",this.player,r)}static count(e){let r=0;for(let c=0;c<e.length;c++)r+=e[c].score;return r}}function q(){function p(){let s=parseInt(localStorage.getItem("bj-pts")||"250");const o=parseInt(localStorage.getItem("game-wins")||"0"),a=parseInt(localStorage.getItem("prev-wins")||"0");return s+=(o-a)*250,localStorage.setItem("bj-pts",s.toString()),localStorage.setItem("prev-wins",o.toString()),s}let e=p();const r=document.getElementById("chips");r.textContent=e.toString();const c=document.getElementById("bet");c.max=e.toString();const t=new l(e),u=document.getElementById("bust");u.onclose=i;const n=document.getElementById("win");n.onclose=i;const y=document.getElementById("bj");y.onclose=i;const k=document.getElementById("lose");k.onclose=i;const E=document.getElementById("draw");E.onclose=i;const S=document.getElementById("backPicker");localStorage.backTheme&&(S.value=localStorage.backTheme,document.documentElement.dataset.cardBack=localStorage.backTheme),S.addEventListener("change",()=>{const s=S.value;localStorage.backTheme=s,console.log("color theme saved.",s),document.documentElement.dataset.cardBack=s});const d=document.getElementById("hit");d.addEventListener("click",()=>{t.hit();const o=m.querySelector(".card").cloneNode(!0);o.dataset.card=t.player[t.player.length-1].toString(),m.appendChild(o),console.log(t.playerScore),t.playerScore>21&&(d.classList.toggle("hidden",!0),h.classList.toggle("hidden",!0),u.showModal()),t.playerScore===21&&(d.classList.toggle("hidden",!0),h.classList.toggle("hidden",!0),y.showModal())});function i(){f.classList.toggle("hidden",!1),d.classList.toggle("hidden",!0),h.classList.toggle("hidden",!0);const s=m.querySelectorAll(".card");for(let a=s.length-1;a>1;a--)s[a].remove();s[0].dataset.card="back",s[1].dataset.card="back";const o=g.querySelectorAll(".card");for(let a=o.length-1;a>1;a--)o[a].remove();o[0].dataset.card="back",o[1].dataset.card="back"}const h=document.getElementById("stand");h.addEventListener("click",()=>{t.stand();const s=g.querySelectorAll(".card");s[0].dataset.card=t.dealer[0].toString();for(let w=t.dealer.length-1;w>1;w--){const I=g.querySelector(".card").cloneNode(!0);I.dataset.card=t.dealer[w].toString(),g.appendChild(I)}const o=t.dealerScore,a=t.playerScore;if(o>21){console.log("dealer bust"),n.showModal();return}if(o===a){console.log("draw"),E.showModal();return}if(o>a){console.log("dealer win"),k.showModal();return}if(o<a){console.log("player bust"),n.showModal();return}});const g=document.getElementById("dealer"),m=document.getElementById("player"),f=document.getElementById("deal");f.addEventListener("click",()=>{f.classList.toggle("hidden",!0),d.classList.toggle("hidden",!1),h.classList.toggle("hidden",!1),t.deal();const s=g.querySelectorAll(".card");s[1].dataset.card=t.dealer[1].toString();const o=m.querySelectorAll(".card");if(o[0].dataset.card=t.player[0].toString(),o[1].dataset.card=t.player[1].toString(),t.playerScore===21){console.log("21 dealt"),y.showModal();return}}),document.getElementById("themes").addEventListener("click",()=>{document.getElementById("ui").classList.toggle("hidden")})}document.addEventListener("astro:page-load",q);
