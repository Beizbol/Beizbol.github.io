import{c as F}from"./confetti.module.c4688150.js";import"./hoisted.61ae0013.js";function S(){console.log("init");const m=5,h=500,b=500,q=document.querySelector("[data-keyboard]"),d=document.querySelector("[data-alert]"),u=document.querySelector("[data-guess-grid]"),M=Date.now()-Date.UTC(new Date().getFullYear(),0,1),C=Math.floor(M/1e3/60/60/24),r={targetWord:targetWords[C]};function N(){console.log("load tiles");const t=new Date,e=[t.getDate(),t.getMonth(),t.getFullYear()].join(" "),o=localStorage.getItem("date");if(!o||o!=e)return;const n=document.querySelector("dialog");n.addEventListener("close",()=>{switch(n.returnValue){case"Load":y();break;default:_();break}y()}),n.showModal()}function _(){const t=Math.floor(Math.random()*targetWords.length);r.targetWord=targetWords[t]}function y(){const t=[...l("*")],e=localStorage.getItem("tiles");if(!e)return;const o=e.split(" ");let n=[];o.forEach((s,a,i)=>{if(t[a].dataset.letter=s,t[a].textContent=s.toUpperCase(),t[a].dataset.state="active",(a+1)%5==0){const g=i.slice(a-4,a+1).join("");n.push(g)}}),console.log(n),n.forEach((s,a)=>{const i=D(s);t.slice(5*a,5*a+5).forEach((U,I)=>A(U,i[I],I*h/2))}),setTimeout(()=>w(n[n.length-1]),1500),console.log("loaded")}function v(){const t=[...l('[data-state="active"]')];if(t.length!==m){c("Not enough letters"),W(t);return}const e=t.reduce((n,s)=>n+s.dataset.letter,"");if(!e)return;if(!dictionary.includes(e)){c("Not in word list"),W(t);return}f(),O();const o=D(e);t.forEach((n,s)=>{A(n,o[s],s*h/2)}),w(e)}function l(t){return[...u.querySelectorAll(t)].filter(n=>n instanceof HTMLElement).map(n=>n)}function G(t){const e=u.querySelector(t);return e instanceof HTMLElement?e:null}function T(){console.log("start"),console.log(r.targetWord),document.querySelector("button.del").addEventListener("click",E),document.addEventListener("click",k),document.addEventListener("keydown",p)}function f(){console.log("stop"),document.removeEventListener("click",k),document.removeEventListener("keydown",p)}function k(t){if(t.target.matches("[data-key]")){L(t.target.dataset.key);return}if(t.target.matches("[data-enter]")){v();return}}function L(t){if(l('[data-state="active"]').length>=m)return;const o=G(":not([data-letter])");o!=null&&(o.dataset.letter=t.toLowerCase(),o.textContent=t,o.dataset.state="active")}function E(){const t=l('[data-state="active"]');console.log(t);const e=t[t.length-1];if(console.log(e),e==null){console.log("no last tile");return}e.textContent="",delete e.dataset.state,delete e.dataset.letter}function p(t){if(t.key==="Enter"){v();return}if(t.key==="Backspace"||t.key==="Delete"){E();return}if(t.key.match(/^[a-z]$/)){L(t.key);return}}function O(){const o=[...l("[data-letter]")].map((a,i,g)=>a.dataset.letter).join(" ");localStorage.setItem("tiles",o);const n=new Date,s=[n.getDate(),n.getMonth(),n.getFullYear()].join(" ");localStorage.setItem("date",s)}function w(t){if(t===r.targetWord){c("You Win",5e3),j(),F(),f();return}u.querySelectorAll(":not([data-letter])").length===0&&(c(r.targetWord.toUpperCase()),f()),T()}function D(t){if(t===r.targetWord)return Array(5).fill("correct");let e=Array(5).fill("wrong-location"),o=r.targetWord.split("");for(let n=0;n<t.length;n++){const s=t.charAt(n);r.targetWord.charAt(n);const a=r.targetWord.indexOf(s);switch(a){case n:e[n]="correct",o[n]="";break;case-1:e[n]="wrong";break;default:e[n]="wrong-location",o[a]="";break}}return e}function A(t,e,o){const n=t.dataset.letter,s=q.querySelector(`[data-key="${n}"i]`);setTimeout(()=>{t.classList.add("flip")},o),t.addEventListener("transitionend",()=>{t.classList.remove("flip"),s&&s.classList.add(e),t.dataset.state=e},{once:!0})}function c(t,e=5e3){d.textContent=t,d.classList.remove("hide"),e!=null&&setTimeout(()=>{d.classList.add("hide")},e)}function W(t){t.forEach(e=>{e.classList.add("shake"),e.addEventListener("animationend",()=>{e.classList.remove("shake")},{once:!0})})}function j(){l("*").forEach((e,o)=>{setTimeout(()=>{e.classList.add("dance"),e.addEventListener("animationend",()=>{e.classList.remove("dance")},{once:!0})},o*b/5)})}N(),T()}S();document.addEventListener("astro:after-swap",()=>{console.log("astro page load"),S()});
