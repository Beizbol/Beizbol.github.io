import{c as E}from"./confetti.module.BxKCmZ95.js";const k=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),I=document.querySelector(".scratch-card-cover"),m=document.querySelector(".scratch-card-canvas-render"),u=document.querySelector(".scratch-card-cover-container"),T=document.querySelector(".scratch-card-image"),c=document.getElementById("canvas"),C=c.getContext("2d");let g=0,f=0,R=null;const l=window.devicePixelRatio||1,p=c.offsetWidth*l,L=c.offsetHeight*l;c.width=p;c.height=L;C.scale(l,l);k&&c.classList.add("hidden");c.addEventListener("pointerdown",t=>{I.classList.remove("shine"),{x:g,y:f}=y(t),clearTimeout(R),c.addEventListener("pointermove",w),window.addEventListener("pointerup",e=>{c.removeEventListener("pointermove",w),R=setTimeout(()=>{q()},500)},{once:!0})});const q=()=>{const e=C.getImageData(0,0,p,L).data;let a=0;for(let n=0;n<e.length;n+=4){const s=e[n],i=e[n+1],r=e[n+2],d=e[n+3];s===0&&i===0&&r===0&&d===255&&a++}a*100/(p*L)>=45&&(u.classList.add("clear"),E(),T.classList.add("animate"),u.addEventListener("transitionend",()=>{u.classList.add("hidden")},{once:!0}))},y=({clientX:t,clientY:e})=>{const{left:a,top:o}=c.getBoundingClientRect();return{x:t-a,y:e-o}},x=(t,e,a,o,n)=>{for(var s=Math.abs(o-e),i=Math.abs(n-a),r=Math.sqrt(s*s+i*i),d=r/50,v=0,h,b,P;v<r;)h=Math.min(1,v/r),b=e+(o-e)*h,P=a+(n-a)*h,t.beginPath(),t.arc(b,P,16,0,Math.PI*2),t.fill(),v+=d},D=()=>{c.toBlob(t=>{const e=URL.createObjectURL(t);previousUrl=m.src,m.src=e,previousUrl?URL.revokeObjectURL(previousUrl):m.classList.remove("hidden"),previousUrl=e})};let U=null;const w=t=>{const{x:e,y:a}=y(t);x(C,g,f,e,a),g=e,f=a,k&&(clearTimeout(U),U=setTimeout(()=>{D()},5))};
