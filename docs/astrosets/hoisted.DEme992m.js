import{c as I}from"./confetti.module.BxKCmZ95.js";import"./hoisted.B1_uNwtp.js";const q=["C","D","H","S"],j=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"],M={A:11,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10};class _{faceUp=!1;suit;rank;get score(){return M[this.rank]}constructor(t,s){this.suit=q[t],this.rank=j[s]}toString(){return`${this.suit}-${this.rank}`}flip(){this.faceUp=!this.faceUp}show(){this.faceUp=!0}hide(){this.faceUp=!1}}class v{cards=[];constructor(){for(let t=0;t<4;t++)for(let s=1;s<=13;s++)this.cards.push(new _(t,s))}shuffle(t=1e3){const s=this.cards.length-1;for(let e=0;e<t;e++){const c=e%s,d=this.cards[c],h=Math.floor(Math.random()*s);this.cards[c]=this.cards[h],this.cards[h]=d}}draw(t=2){return this.cards.splice(0,t)}toString(){return this.cards.map(t=>t.toString()).join(" ")}}class n{bet;chips;deck;once;isSplit;player=[];player_split=[];dealer=[];constructor(t){this.once=!1,this.isSplit=!1,this.bet=5,this.chips=t,this.deck=new v}reset(){this.once=!1,this.isSplit=!1,this.player=[],this.player_split=[],this.dealer=[],this.deck=new v}deal(t){return this.reset(),this.chips<t?(alert("Not enough chips!"),"poor"):(this.bet=t,this.chips-=t,this.deck.shuffle(),this.player=this.deck.draw(2),this.dealer=this.deck.draw(2),this.player[0].rank===this.player[1].rank?"split":n.count(this.player)===21?"21":"deal")}hit(){const t=this.deck.draw(1)[0];this.player.push(t),console.log("hit player:",this.player);const s=n.count(this.player);return s===21?(this.payout("21"),"21"):s>21?"bust":"hit"}stand(){if(!this.once&&this.isSplit)return this.once=!0,"split";for(;n.count(this.dealer)<17;){const c=this.deck.draw(1)[0];this.dealer.push(c),console.log("hit dealer:",this.dealer)}const t=n.count(this.dealer),s=n.count(this.player),e=n.judge(s,t);if(this.isSplit){const c=n.count(this.player_split),d=n.judge(c,t);return[e,d]}return e}split(){return this.chips<this.bet?(alert("You're out of chips!"),"poor"):(this.chips-=this.bet,this.bet+=this.bet,this.player_split.push(this.player.pop()),this.player.push(this.deck.draw(1)[0]),this.player_split.push(this.deck.draw(1)[0]),console.log("split player:",this.player,this.player_split),this.isSplit=!0,"")}payout(t){switch(t){case"21":this.chips+=this.bet*3;break;case"win":this.chips+=this.bet*2;break;case"draw":this.chips+=this.bet;break}}static judge(t,s){return t>21?"lose":s>21||t>s?"win":t<s?"lose":"draw"}static count(t){let s=0,e=!1;for(let c=0;c<t.length;c++)s+=t[c].score,t[c].rank==="A"&&(e=!0);return s>21&&e&&(s-=10),s}}function C(){let g=250;const t=document.getElementById("chips");t.textContent=g.toString();const s=document.getElementById("bet");s.max=g.toString();const e=new n(g),c=document.getElementById("bust");c.onclose=m;const d=document.getElementById("win");d.onclose=m;const h=document.getElementById("bj");h.onclose=m;const w=document.getElementById("lose");w.onclose=m;const E=document.getElementById("draw");E.onclose=m;const S=document.getElementById("backPicker");localStorage.backTheme&&(S.value=localStorage.backTheme,document.documentElement.dataset.cardBack=localStorage.backTheme),S.addEventListener("change",()=>{const r=S.value;localStorage.backTheme=r,console.log("color theme saved.",r),document.documentElement.dataset.cardBack=r});const k=document.getElementById("split");k.addEventListener("click",()=>{if(e.split()==="poor"){alert("Not enough chips.");return}const a=o.querySelectorAll(".card");a[0].dataset.card=e.player[0].toString(),a[1].dataset.card=e.player[1].toString(),k.classList.toggle("hidden",!0)});const u=document.getElementById("hit");u.addEventListener("click",()=>{const r=e.hit(),i=o.querySelector(".card").cloneNode(!0);switch(i.dataset.card=e.player[e.player.length-1].toString(),o.appendChild(i),r){case"21":u.classList.toggle("hidden",!0),p.classList.toggle("hidden",!0),I(),h.showModal();break;case"bust":u.classList.toggle("hidden",!0),p.classList.toggle("hidden",!0),c.showModal();break}});function B(){const r=o.querySelectorAll(".card");for(let a=r.length-1;a>2;a--)r[a].remove()}function m(){b.classList.toggle("hidden",!1),u.classList.toggle("hidden",!0),p.classList.toggle("hidden",!0);const r=o.querySelectorAll(".card");for(let i=r.length-1;i>1;i--)r[i].remove();r[0].dataset.card="back",r[1].dataset.card="back";const a=y.querySelectorAll(".card");for(let i=a.length-1;i>1;i--)a[i].remove();a[0].dataset.card="back",a[1].dataset.card="back"}function A(r){const a=document.getElementById("chips");a.textContent=r.toString(),localStorage.setItem("bj-pts",r.toString())}const p=document.getElementById("stand");p.addEventListener("click",()=>{const r=e.stand();if(r==="split"){const l=o.querySelectorAll(".card");l[0].dataset.card=e.player_split[0].toString(),l[1].dataset.card=e.player_split[1].toString(),B(),console.log("split_cleaned."),b.classList.toggle("hidden",!0),u.classList.toggle("hidden",!1),p.classList.toggle("hidden",!1);return}const a=y.querySelectorAll(".card"),i=y.querySelector(".card");for(let l=0;l<e.dealer.length;l++){const f=e.dealer[l].toString();if(a[l])a[l].dataset.card=f;else{const L=i.cloneNode(!0);L.dataset.card=f,y.appendChild(L)}}switch(A(e.chips),r){case"win":d.showModal();break;case"lose":w.showModal();break;case"draw":E.showModal();break}});const y=document.getElementById("dealer"),o=document.getElementById("player"),b=document.getElementById("deal");b.addEventListener("click",()=>{console.log("deal clicked."),localStorage.getItem("bj-pts");const r=document.getElementById("bet"),a=parseInt(r.value)||0;if(a===0)return;b.classList.toggle("hidden",!0),u.classList.toggle("hidden",!1),p.classList.toggle("hidden",!1);const i=e.deal(a),l=y.querySelectorAll(".card");l[1].dataset.card=e.dealer[1].toString();const f=o.querySelectorAll(".card");switch(f[0].dataset.card=e.player[0].toString(),f[1].dataset.card=e.player[1].toString(),i){case"21":I(),h.showModal();break;case"split":k.classList.toggle("hidden",!1);break}}),document.getElementById("themes").addEventListener("click",()=>{document.getElementById("ui").classList.toggle("hidden")})}document.addEventListener("astro:page-load",C);
