import"./hoisted.CmKvcf_A.js";const I=["C","D","H","S"],b=["","A","2","3","4","5","6","7","8","9","10","J","Q","K"],L={A:11,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,J:10,Q:10,K:10};class v{faceUp=!1;suit;rank;get score(){return L[this.rank]}constructor(t,r){this.suit=I[t],this.rank=b[r]}toString(){return`${this.suit}-${this.rank}`}flip(){this.faceUp=!this.faceUp}show(){this.faceUp=!0}hide(){this.faceUp=!1}}class B{cards=[];constructor(){for(let t=0;t<4;t++)for(let r=1;r<=13;r++)this.cards.push(new v(t,r))}shuffle(t=1e3){const r=this.cards.length-1;for(let e=0;e<t;e++){const l=e%r,n=this.cards[l],d=Math.floor(Math.random()*r);this.cards[l]=this.cards[d],this.cards[d]=n}}draw(t=2){return this.cards.splice(0,t)}toString(){return this.cards.map(t=>t.toString()).join(" ")}}class c{chips;deck;player=[];dealer=[];get playerScore(){return c.count(this.player)}get dealerScore(){return c.count(this.dealer)}constructor(t){this.chips=t,this.deck=new B}deal(){if(this.chips<1){alert("You're out of chips!");return}this.deck.shuffle(),this.player=this.deck.draw(2),this.dealer=this.deck.draw(2)}hit(){const t=this.deck.draw(1)[0];this.player.push(t),console.log("hit player:",this.player)}stand(){for(;c.count(this.dealer)<17;){const e=this.deck.draw(1)[0];this.dealer.push(e),console.log("hit dealer:",this.dealer)}const t=c.count(this.dealer);console.log("dealer:",this.dealer,t);const r=c.count(this.player);console.log("player:",this.player,r)}static count(t){let r=0;for(let e=0;e<t.length;e++)r+=t[e].score;return r}}function M(){function p(){let s=parseInt(localStorage.getItem("bj-pts")||"250");const o=parseInt(localStorage.getItem("game-wins")||"0"),a=parseInt(localStorage.getItem("prev-wins")||"0");return s+=(o-a)*250,localStorage.setItem("bj-pts",s.toString()),localStorage.setItem("prev-wins",o.toString()),s}let t=p();const r=document.getElementById("chips");r.textContent=t.toString();const e=new c(t),l=document.getElementById("bust");l.onclose=h;const n=document.getElementById("win");n.onclose=h;const d=document.getElementById("bj");d.onclose=h;const w=document.getElementById("lose");w.onclose=h;const k=document.getElementById("draw");k.onclose=h;const y=document.getElementById("backPicker");localStorage.backTheme&&(y.value=localStorage.backTheme,document.documentElement.dataset.cardBack=localStorage.backTheme),y.addEventListener("change",()=>{const s=y.value;localStorage.backTheme=s,console.log("color theme saved.",s),document.documentElement.dataset.cardBack=s});const i=document.getElementById("hit");i.addEventListener("click",()=>{e.hit();const o=m.querySelector(".card").cloneNode(!0);o.dataset.card=e.player[e.player.length-1].toString(),m.appendChild(o),console.log(e.playerScore),e.playerScore>21&&(i.classList.toggle("hidden",!0),g.classList.toggle("hidden",!0),l.showModal()),e.playerScore===21&&(i.classList.toggle("hidden",!0),g.classList.toggle("hidden",!0),d.showModal())});function h(){S.classList.toggle("hidden",!1),i.classList.toggle("hidden",!0),g.classList.toggle("hidden",!0);const s=m.querySelectorAll(".card");for(let a=s.length-1;a>1;a--)s[a].remove();s[0].dataset.card="back",s[1].dataset.card="back";const o=u.querySelectorAll(".card");for(let a=o.length-1;a>1;a--)o[a].remove();o[0].dataset.card="back",o[1].dataset.card="back"}const g=document.getElementById("stand");g.addEventListener("click",()=>{e.stand();const s=u.querySelectorAll(".card");s[0].dataset.card=e.dealer[0].toString();for(let f=e.dealer.length-1;f>1;f--){const E=u.querySelector(".card").cloneNode(!0);E.dataset.card=e.dealer[f].toString(),u.appendChild(E)}const o=e.dealerScore,a=e.playerScore;if(o>21){console.log("dealer bust"),n.showModal();return}if(o===a){console.log("draw"),k.showModal();return}if(o>a){console.log("dealer win"),w.showModal();return}if(o<a){console.log("player bust"),n.showModal();return}});const u=document.getElementById("dealer"),m=document.getElementById("player"),S=document.getElementById("deal");S.addEventListener("click",()=>{S.classList.toggle("hidden",!0),i.classList.toggle("hidden",!1),g.classList.toggle("hidden",!1),e.deal();const s=u.querySelectorAll(".card");s[1].dataset.card=e.dealer[1].toString();const o=m.querySelectorAll(".card");o[0].dataset.card=e.player[0].toString(),o[1].dataset.card=e.player[1].toString()}),document.getElementById("themes").addEventListener("click",()=>{document.getElementById("ui").classList.toggle("hidden")})}document.addEventListener("astro:page-load",M);
