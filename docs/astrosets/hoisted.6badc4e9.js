import{c as K}from"./confetti.module.c4688150.js";import"./hoisted.61ae0013.js";function b(){console.log("init");const m=5,v=500,_=500,q=document.querySelector("[data-keyboard]"),i=document.querySelector("[data-alert]"),d=document.querySelector("[data-guess-grid]"),N=Math.floor(Math.random()*targetWords.length),s={targetWord:targetWords[N]},u=document.querySelector("dialog");u.addEventListener("close",()=>{const e=u.returnValue;switch(console.log(e),e){case"restart":D();break;default:M();break}});function C(){console.log("load tiles");const e=localStorage.getItem("target");if(e){u.showModal(),s.targetWord=e;return}if(localStorage.getItem("wordle-visit")){c("Welcome back!",3e3);return}localStorage.setItem("wordle-visit","true"),c("Welcome!",3e3)}function D(){localStorage.removeItem("tiles")}function M(){const e=[...l("*")],t=localStorage.getItem("tiles");if(!t)return;const o=t.split(" ");let n=[];o.forEach((r,a,g)=>{if(e[a].dataset.letter=r,e[a].textContent=r.toUpperCase(),e[a].dataset.state="active",(a+1)%5==0){const W=g.slice(a-4,a+1).join("");n.push(W)}}),console.log(n),n.forEach((r,a)=>{const g=p(r);e.slice(5*a,5*a+5).forEach((H,A)=>I(H,g[A],A*v/2))}),setTimeout(()=>w(n[n.length-1]),1500),console.log("loaded")}function h(){const e=[...l('[data-state="active"]')];if(e.length!==m){c("Not enough letters"),S(e);return}const t=e.reduce((n,r)=>n+r.dataset.letter,"");if(!t)return;if(!dictionary.includes(t)){c("Not in word list"),S(e);return}f(),O();const o=p(t);e.forEach((n,r)=>{I(n,o[r],r*v/2)}),w(t)}function l(e){return[...d.querySelectorAll(e)].filter(n=>n instanceof HTMLElement).map(n=>n)}function G(e){const t=d.querySelector(e);return t instanceof HTMLElement?t:null}function y(){console.log(s.targetWord),document.querySelector("button.del").addEventListener("click",E),document.addEventListener("click",T),document.addEventListener("keydown",L)}function f(){document.removeEventListener("click",T),document.removeEventListener("keydown",L)}function T(e){if(e.target.matches("[data-key]")){k(e.target.dataset.key);return}if(e.target.matches("[data-enter]")){h();return}}function k(e){if(l('[data-state="active"]').length>=m)return;const o=G(":not([data-letter])");o!=null&&(o.dataset.letter=e.toLowerCase(),o.textContent=e,o.dataset.state="active")}function E(){const e=l('[data-state="active"]'),t=e[e.length-1];t!=null&&(t.textContent="",delete t.dataset.state,delete t.dataset.letter)}function L(e){if(e.key==="Enter"){h();return}if(e.key==="Backspace"||e.key==="Delete"){E();return}if(e.key.match(/^[a-z]$/)){k(e.key);return}}function O(){const o=[...l("[data-letter]")].map((n,r,a)=>n.dataset.letter).join(" ");localStorage.setItem("tiles",o),localStorage.setItem("target",s.targetWord)}function U(){let e=parseInt(localStorage.getItem("game-wins")||"0");e+=1,localStorage.setItem("game-wins",e.toString())}function j(){localStorage.removeItem("tiles"),localStorage.removeItem("target"),window.location.reload()}function w(e){if(e===s.targetWord){c("You Win",5e3),x(),K(),f(),U(),setTimeout(j,3e3);return}d.querySelectorAll(":not([data-letter])").length===0&&(c(s.targetWord.toUpperCase()),f()),y()}function p(e){if(e===s.targetWord)return Array(5).fill("correct");let t=Array(5).fill("wrong-location"),o=s.targetWord.split("");for(let n=0;n<e.length;n++){const r=e.charAt(n);s.targetWord.charAt(n);const a=s.targetWord.indexOf(r);switch(a){case n:t[n]="correct",o[n]="";break;case-1:t[n]="wrong";break;default:t[n]="wrong-location",o[a]="";break}}return t}function I(e,t,o){const n=e.dataset.letter,r=q.querySelector(`[data-key="${n}"i]`);setTimeout(()=>{e.classList.add("flip")},o),e.addEventListener("transitionend",()=>{e.classList.remove("flip"),r&&r.classList.add(t),e.dataset.state=t},{once:!0})}function c(e,t=5e3){i.textContent=e,i.classList.remove("hide"),t!=null&&setTimeout(()=>{i.classList.add("hide")},t)}function S(e){e.forEach(t=>{t.classList.add("shake"),t.addEventListener("animationend",()=>{t.classList.remove("shake")},{once:!0})})}function x(){l("*").forEach((t,o)=>{setTimeout(()=>{t.addEventListener("animationend",()=>{t.classList.remove("dance")},{once:!0}),t.classList.add("dance")},o*_/5)})}C(),y()}b();document.addEventListener("astro:after-swap",()=>{console.log("astro page load"),b()});
