import"./hoisted.d5332371.js";class u{id;x;y;w;h;text;icon;bg;font;color;constructor(e,i,o,c,p){this.id=p??Math.random()*1e3,this.x=e.left,this.y=e.top,this.w=e.width,this.h=e.height,this.text=i,this.icon=new Image,this.icon.src=c,this.bg=o,this.font="16px sans-serif",this.color="#FFFFFF"}updateIcon(e){this.icon.src=e}updateText(e){this.text=e,this.w=e.length*8+50}move(e,i){this.x=e,this.y=i}drawPin(e){e.fillStyle=this.bg,e.fillRect(this.x-24,this.y-this.h/2,this.w,this.h),e.beginPath();const i=this.x+this.w/2-24;e.moveTo(i-10,this.y+5),e.lineTo(i,this.y+25),e.lineTo(i+10,this.y+5),e.closePath(),e.fill(),e.drawImage(this.icon,this.x-20,this.y-12,24,24),e.fillStyle=this.color,e.font=this.font,e.fillText(this.text,this.x+8,this.y+6)}isMouseOver(e,i){return e>this.x-36&&e<this.x-12+this.w&&i>this.y-20&&i<this.y+this.h}twin(){return new u({left:this.x,top:this.y,width:this.w,height:this.h},this.text,this.bg,this.icon.src)}clone(){return new u({left:this.x,top:this.y,width:this.w,height:this.h},this.text,this.bg,this.icon.src,this.id)}}const s=document.getElementById("canvas"),h=s.getContext("2d"),l=document.getElementById("pcanvas"),g=l.getContext("2d"),w=document.getElementById("download");w.onclick=()=>{const t=document.createElement("a");t.download=E,t.href=s.toDataURL(),t.click()};const b=document.getElementById("pick"),r=new Image,v=document.getElementById("icon-img");v.onload=()=>{a()};const I=document.getElementById("icons"),y=document.getElementById("pinColor"),L=document.getElementById("pinText");document.getElementById("ptxt");let d=new u({top:20,left:40,width:100,height:30},"Pin Text",y.value,v.src);document.getElementById("cpin");const n={placed:[],held:null,canvasHover:!1,pin_offset_x:0,pin_offset_y:0};a();s.addEventListener("mouseenter",t=>{n.canvasHover=!0});s.addEventListener("mouseleave",t=>{n.canvasHover=!1,n.held&&x()});l.addEventListener("mouseenter",t=>{n.pcanvasHover=!0});l.addEventListener("mouseleave",t=>{n.held&&(n.held.move(40,20),a()),n.pcanvasHover=!1});s.addEventListener("mousemove",t=>{if(!n.held||!n.canvasHover)return;const e=s.getBoundingClientRect(),i=t.clientX-e.left,o=t.clientY-e.top;n.held.move(i,o),m()});let f=!1;l.addEventListener("mousemove",t=>{if(!n.held||!n.pcanvasHover)return;f=!0;const e=l.getBoundingClientRect(),i=t.clientX-e.left,o=t.clientY-e.top;n.held.move(i,o),a()});s.addEventListener("mousedown",t=>{if(!n.canvasHover)return;const e=s.getBoundingClientRect(),i=t.clientX-e.left,o=t.clientY-e.top;for(let c=0;c<n.placed.length;c++){const p=n.placed[c];if(p.isMouseOver(i,o)){s.style.cursor="grabbing",n.held=p,n.placed.splice(c,1);return}}});l.addEventListener("mousedown",t=>{if(!n.pcanvasHover)return;const e=l.getBoundingClientRect(),i=t.clientX-e.left,o=t.clientY-e.top;d.isMouseOver(i,o)&&(l.style.cursor="grabbing",n.held=d)});function x(){n.held&&(f?n.placed.push(n.held.twin()):n.placed.push(n.held.clone()),n.held=null,m())}document.addEventListener("mouseup",t=>{s.style.cursor="grab",l.style.cursor="grab",n.held&&(n.canvasHover&&x(),d.move(40,20),a(),f=!1,n.pin_offset_x=0,n.pin_offset_y=0)});I.addEventListener("change",t=>{v.src=t.target.value,d.updateIcon(t.target.value),a()});y.addEventListener("change",t=>{preview.style.backgroundColor=t.target.value,a()});L.addEventListener("change",t=>{d.updateText(t.target.value),a()});let E="";b.addEventListener("change",t=>{if(t.target.files.length<1){alert("No image files selected.");return}if(t.target.files.length>1){alert("One image file at a time.");return}const e=t.target.files[0],i=URL.createObjectURL(e);r.src=i,r.onload=()=>{E=e.name.slice(0,-3)+"png",w.disabled=!1;const{width:o,height:c}=r;h.canvas.width=o,h.canvas.height=c,l.style.width=o+"px",s.style.width=o+"px",s.style.height=c+"px",m()}});function m(){h.clearRect(0,0,s.width,s.height),r.src&&h.drawImage(r,0,0);for(let t=0;t<n.placed.length;t++)n.placed[t].drawPin(h);n.held&&n.held.drawPin(h)}function a(){g.clearRect(0,0,g.canvas.width,g.canvas.height),d.drawPin(g)}
